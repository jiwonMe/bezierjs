(()=>{var{abs:O,min:ct,max:ft,cos:N,sin:F,acos:V,atan2:P,sqrt:E,pow:j}=Math;function G(e){return e<0?-j(-e,1/3):j(e,1/3)}var H=Math.PI,D=2*H,U=H/2,pt=1e-6,K=Number.MAX_SAFE_INTEGER||9007199254740991,$=Number.MIN_SAFE_INTEGER||-9007199254740991,yt={x:0,y:0,z:0},X=[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],tt=[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872];var ut=function(e,n){let r=n(e),i=r.x*r.x+r.y*r.y;return typeof r.z<"u"&&(i+=r.z*r.z),E(i)},Z=function(e,n,r){if(e===0)return n[0].t=0,n[0];let i=n.length-1;if(e===1)return n[i].t=1,n[i];let s=1-e,o=n;if(i===0)return n[0].t=e,n[0];if(i===1){let f={x:s*o[0].x+e*o[1].x,y:s*o[0].y+e*o[1].y,t:e};return r&&(f.z=s*o[0].z+e*o[1].z),f}if(i<4){let f=s*s,u=e*e,h,a,l,p=0;i===2?(o=[o[0],o[1],o[2],yt],h=f,a=s*e*2,l=u):i===3&&(h=f*s,a=f*e*3,l=s*u*3,p=e*u);let m={x:h*o[0].x+a*o[1].x+l*o[2].x+p*o[3].x,y:h*o[0].y+a*o[1].y+l*o[2].y+p*o[3].y,t:e};return r&&(m.z=h*o[0].z+a*o[1].z+l*o[2].z+p*o[3].z),m}let c=JSON.parse(JSON.stringify(n));for(;c.length>1;){for(let f=0;f<c.length-1;f++)c[f]={x:c[f].x+(c[f+1].x-c[f].x)*e,y:c[f].y+(c[f+1].y-c[f].y)*e},typeof c[f].z<"u"&&(c[f].z=c[f].z+(c[f+1].z-c[f].z)*e);c.splice(c.length-1,1)}return c[0].t=e,c[0]},mt=function(e,n,r,i){let s=1-e,o=r,c=n,f=o[0],u=o[1],h=o[2],a=o[3],l;if(f*=s,u*=e,c.length===2)return l=f+u,{x:(f*c[0].x+u*c[1].x)/l,y:(f*c[0].y+u*c[1].y)/l,z:i?(f*c[0].z+u*c[1].z)/l:!1,t:e};if(f*=s,u*=2*s,h*=e*e,c.length===3)return l=f+u+h,{x:(f*c[0].x+u*c[1].x+h*c[2].x)/l,y:(f*c[0].y+u*c[1].y+h*c[2].y)/l,z:i?(f*c[0].z+u*c[1].z+h*c[2].z)/l:!1,t:e};if(f*=s,u*=1.5*s,h*=3*s,a*=e*e*e,c.length===4)return l=f+u+h+a,{x:(f*c[0].x+u*c[1].x+h*c[2].x+a*c[3].x)/l,y:(f*c[0].y+u*c[1].y+h*c[2].y+a*c[3].y)/l,z:i?(f*c[0].z+u*c[1].z+h*c[2].z+a*c[3].z)/l:!1,t:e}},dt=function(e,n){let r=[];for(let i=e,s=i.length,o=s-1;s>1;s--,o--){let c=[];for(let f=0,u;f<o;f++)u={x:o*(i[f+1].x-i[f].x),y:o*(i[f+1].y-i[f].y)},n&&(u.z=o*(i[f+1].z-i[f].z)),c.push(u);r.push(c),i=c}return r},gt=function(e){let r=X.length,i=0;for(let s=0,o;s<r;s++)o=.5*X[s]+.5,i+=tt[s]*ut(o,e);return .5*i};var zt=function(e,n,r){return n<=e&&e<=r||T(e,n)||T(e,r)},T=function(e,n,r){return O(e-n)<=(r||pt)},_t=function(e,n,r,i,s){let o=r-n,c=s-i,f=e-n,u=f/o;return i+c*u},vt=function(e,n,r){let i={x:n.x+e*(r.x-n.x),y:n.y+e*(r.y-n.y)};return n.z!==void 0&&r.z!==void 0&&(i.z=n.z+e*(r.z-n.z)),i},at=function(e){let n=e.x+"/"+e.y;return typeof e.z<"u"&&(n+="/"+e.z),n},wt=function(e){return"["+e.map(at).join(", ")+"]"},kt=function(e){return JSON.parse(JSON.stringify(e))},Et=function(e,n,r){let i=n.x-e.x,s=n.y-e.y,o=r.x-e.x,c=r.y-e.y,f=i*c-s*o,u=i*o+s*c;return P(f,u)},Mt=function(e,n){let r=""+e,i=r.indexOf(".");return parseFloat(r.substring(0,i+1+n))},B=function(e,n){let r=e.x-n.x,i=e.y-n.y;return E(r*r+i*i)},Ot=function(e,n){let r=j(2,63),i,s;return e.forEach(function(o,c){s=B(n,o),s<r&&(r=s,i=c)}),{mdist:r,mpos:i}},qt=function(e,n){if(n!==2&&n!==3)return!1;if(typeof e>"u")e=.5;else if(e===0||e===1)return e;let r=j(e,n)+j(1-e,n),i=r-1;return O(i/r)},bt=function(e,n){if(n!==2&&n!==3)return!1;if(typeof e>"u")e=.5;else if(e===0||e===1)return e;let r=j(1-e,n),i=j(e,n)+r;return r/i},Y=function(e,n,r,i,s,o,c,f){let u=(e*i-n*r)*(s-c)-(e-r)*(s*f-o*c),h=(e*i-n*r)*(o-f)-(n-i)*(s*f-o*c),a=(e-r)*(o-f)-(n-i)*(s-c);return a==0?!1:{x:u/a,y:h/a}},lt=function(e,n,r,i){let s=e.x,o=e.y,c=n.x,f=n.y,u=r.x,h=r.y,a=i.x,l=i.y;return Y(s,o,c,f,u,h,a,l)},Ct=function(e,n){return lt(e,e.c,n,n.c)},Q=function(e,n){let r=n.p1.x,i=n.p1.y,s=-P(n.p2.y-i,n.p2.x-r),o=function(c){return{x:(c.x-r)*N(s)-(c.y-i)*F(s),y:(c.x-r)*F(s)+(c.y-i)*N(s)}};return e.map(o)},jt=function(e,n){return e-n};var At=function(e,n){n=n||{p1:{x:0,y:0},p2:{x:1,y:0}};let r=e.length-1,i=Q(e,n),s=function(y){return 0<=y&&y<=1};if(r===2){let y=i[0].y,_=i[1].y,w=i[2].y,C=y-2*_+w;if(C!==0){let S=-E(_*_-y*w),R=-y+_,W=-(S+R)/C,L=-(-S+R)/C;return[W,L].filter(s)}else if(_!==w&&C===0)return[(2*_-w)/(2*_-2*w)].filter(s);return[]}let o=i[0].y,c=i[1].y,f=i[2].y,u=i[3].y,h=-o+3*c-3*f+u,a=3*o-6*c+3*f,l=-3*o+3*c,p=o;if(T(h,0)){if(T(a,0))return T(l,0)?[]:[-p/l].filter(s);let y=E(l*l-4*a*p),_=2*a;return[(y-l)/_,(-l-y)/_].filter(s)}a/=h,l/=h,p/=h;let m=(3*l-a*a)/3,z=m/3,M=(2*a*a*a-9*a*l+27*p)/27,q=M/2,k=q*q+z*z*z,A,v,d,g,b;if(k<0){let y=-m/3,_=y*y*y,w=E(_),C=-M/(2*w),S=C<-1?-1:C>1?1:C,R=V(S),W=G(w),L=2*W;return d=L*(D/3)-a/3,g=L*((R+D)/3)-a/3,b=L*((R+2*D)/3)-a/3,[d,g,b].filter(s)}else{if(k===0)return A=q<0?G(-q):-G(q),d=2*A-a/3,g=-A-a/3,[d,g].filter(s);{let y=E(k);return A=G(-q+y),v=G(q+y),[A-v-a/3].filter(s)}}},Tt=function(e){if(e.length===3){let n=e[0],r=e[1],i=e[2],s=n-2*r+i;if(s!==0){let o=-E(r*r-n*i),c=-n+r,f=-(o+c)/s,u=-(-o+c)/s;return[f,u]}else if(r!==i&&s===0)return[(2*r-i)/(2*(r-i))];return[]}if(e.length===2){let n=e[0],r=e[1];return n!==r?[n/(n-r)]:[]}return[]},nt=function(e,n,r,i,s){let o,c,f,u,h=0,a=0,l=Z(e,n),p=Z(e,r),m=l.x*l.x+l.y*l.y;if(i?(o=E(j(l.y*p.z-p.y*l.z,2)+j(l.z*p.x-p.z*l.x,2)+j(l.x*p.y-p.x*l.y,2)),c=j(m+l.z*l.z,3/2)):(o=l.x*p.y-l.y*p.x,c=j(m,3/2)),o===0||c===0)return{k:0,r:0};if(h=o/c,a=c/o,!s){let z=nt(e-.001,n,r,i,!0).k,M=nt(e+.001,n,r,i,!0).k;u=(M-h+(h-z))/2,f=(O(M-h)+O(h-z))/2}return{k:h,r:a,dk:u,adk:f}},St=function(e){if(e.length<4)return[];let n=Q(e,{p1:e[0],p2:e.slice(-1)[0]}),r=n[2].x*n[1].y,i=n[3].x*n[1].y,s=n[1].x*n[2].y,o=n[3].x*n[2].y,c=18*(-3*r+2*i+3*s-o),f=18*(3*r-i-3*s),u=18*(s-r);if(T(c,0)){if(!T(f,0)){let p=-u/f;if(0<=p&&p<=1)return[p]}return[]}let h=2*c;if(T(h,0))return[];let a=f*f-4*c*u;if(a<0)return[];let l=Math.sqrt(a);return[(l-f)/h,-(f+l)/h].filter(function(p){return 0<=p&&p<=1})};var et=function(e,n){let r=["x","y"],i=r.length;for(let s=0,o,c,f,u;s<i;s++)if(o=r[s],c=e[o].mid,f=n[o].mid,u=(e[o].size+n[o].size)/2,O(c-f)>=u)return!1;return!0},Rt=function(e,n){n.x.min<e.x.min&&(e.x.min=n.x.min),n.y.min<e.y.min&&(e.y.min=n.y.min),n.z&&n.z.min<e.z.min&&(e.z.min=n.z.min),n.x.max>e.x.max&&(e.x.max=n.x.max),n.y.max>e.y.max&&(e.y.max=n.y.max),n.z&&n.z.max>e.z.max&&(e.z.max=n.z.max),e.x.mid=(e.x.min+e.x.max)/2,e.y.mid=(e.y.min+e.y.max)/2,e.z&&(e.z.mid=(e.z.min+e.z.max)/2),e.x.size=e.x.max-e.x.min,e.y.size=e.y.max-e.y.min,e.z&&(e.z.size=e.z.max-e.z.min)},ht=function(e,n,r){let i=e.bbox(),s=n.bbox(),o=1e5,c=r||.5;if(i.x.size+i.y.size<c&&s.x.size+s.y.size<c)return[(o*(e._t1+e._t2)/2|0)/o+"/"+(o*(n._t1+n._t2)/2|0)/o];let f=e.split(.5),u=n.split(.5),h=[{left:f.left,right:u.left},{left:f.left,right:u.right},{left:f.right,right:u.right},{left:f.right,right:u.left}];h=h.filter(function(l){return et(l.left.bbox(),l.right.bbox())});let a=[];return h.length===0||(h.forEach(function(l){a=a.concat(ht(l.left,l.right,c))}),a=a.filter(function(l,p){return a.indexOf(l)===p})),a},Nt=function(e,n,r){let i=n.x-e.x,s=n.y-e.y,o=r.x-n.x,c=r.y-n.y,f=i*N(U)-s*F(U),u=i*F(U)+s*N(U),h=o*N(U)-c*F(U),a=o*F(U)+c*N(U),l=(e.x+n.x)/2,p=(e.y+n.y)/2,m=(n.x+r.x)/2,z=(n.y+r.y)/2,M=l+f,q=p+u,k=m+h,A=z+a,v=Y(l,p,M,q,m,z,k,A),d=B(v,e),g=P(e.y-v.y,e.x-v.x),b=P(n.y-v.y,n.x-v.x),y=P(r.y-v.y,r.x-v.x),_;return g<y?((g>b||b>y)&&(g+=D),g>y&&(_=y,y=g,g=_)):y<b&&b<g?(_=y,y=g,g=_):y+=D,v.s=g,v.e=y,v.r=d,v},rt=function(e){let n=K,r=K,i=$,s=$;return e.forEach(function(o){let c=o.bbox();n>c.x.min&&(n=c.x.min),r>c.y.min&&(r=c.y.min),i<c.x.max&&(i=c.x.max),s<c.y.max&&(s=c.y.max)}),{x:{min:n,mid:(n+i)/2,max:i,size:i-n},y:{min:r,mid:(r+s)/2,max:s,size:s-r}}},it=function(e,n,r,i,s){if(!et(n,i))return[];let o=[],c=[e.startcap,e.forward,e.back,e.endcap],f=[r.startcap,r.forward,r.back,r.endcap];return c.forEach(function(u){u.virtual||f.forEach(function(h){if(h.virtual)return;let a=u.intersects(h,s);a.length>0&&(a.c1=u,a.c2=h,a.s1=e,a.s2=r,o.push(a))})}),o},Ft=function(e,n,r){if(!r)return{min:0,max:0};let i=K,s=$,o,c;r.indexOf(0)===-1&&(r=[0].concat(r)),r.indexOf(1)===-1&&r.push(1);for(let f=0,u=r.length;f<u;f++)o=r[f],c=e.get(o),c[n]<i&&(i=c[n]),c[n]>s&&(s=c[n]);return{min:i,mid:(i+s)/2,max:s,size:s-i}};var xt=null;function Ut(e){xt=e}var st=function(e,n){if(!xt)throw new Error("Bezier class not set. Call setBezierClass first.");return new xt(e.x,e.y,(e.x+n.x)/2,(e.y+n.y)/2,n.x,n.y)},It=function(e,n,r){let i=n.points.length,s=e.points.length,o=st(n.points[i-1],e.points[0]),c=st(e.points[s-1],n.points[0]),f={startcap:o,forward:e,back:n,endcap:c,bbox:rt([o,e,n,c])};return f.intersections=function(u){return it(f,f.bbox,u,u.bbox,r)},f};var x={Tvalues:X,Cvalues:tt,arcfn:ut,compute:Z,computeWithRatios:mt,derive:dt,between:zt,approximately:T,length:gt,map:_t,lerp:vt,pointToString:at,pointsToString:wt,copy:kt,angle:Et,round:Mt,dist:B,closest:Ot,abcratio:qt,projectionratio:bt,lli8:Y,lli4:lt,lli:Ct,makeline:st,findbbox:rt,shapeintersections:it,makeshape:It,getminmax:Ft,align:Q,roots:At,droots:Tt,curvature:nt,inflections:St,bboxoverlap:et,expandbox:Rt,pairiteration:ht,getccenter:Nt,numberSort:jt};var I=class{constructor(n){this.curves=[],this._3d=!1,n&&(this.curves=n,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map(function(n){return x.pointsToString(n.points)}).join(", ")+"]"}addCurve(n){this.curves.push(n),this._3d=this._3d||n._3d}length(){return this.curves.map(function(n){return n.length()}).reduce(function(n,r){return n+r})}curve(n){return this.curves[n]}bbox(){let n=this.curves;for(var r=n[0].bbox(),i=1;i<n.length;i++)x.expandbox(r,n[i].bbox());return r}offset(n){let r=[];return this.curves.forEach(function(i){r.push(...i.offset(n))}),new I(r)}};var ot=class{constructor(n){let r=n&&n.forEach?n:Array.from(arguments).slice(),i=!1;if(typeof r[0]=="object"){i=r.length;let m=[];r.forEach(function(z){["x","y","z"].forEach(function(M){typeof z[M]<"u"&&m.push(z[M])})}),r=m}let s=!1,o=r.length;if(i){if(i>4){if(arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");s=!0}}else if(o!==6&&o!==8&&o!==9&&o!==12&&arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");let c=this._3d=!s&&(o===9||o===12)||n&&n[0]&&typeof n[0].z<"u",f=this.points=[];for(let m=0,z=c?3:2;m<o;m+=z){var u={x:r[m],y:r[m+1]};c&&(u.z=r[m+2]),f.push(u)}let h=this.order=f.length-1,a=this.dims=["x","y"];c&&a.push("z"),this.dimlen=a.length;let l=x.align(f,{p1:f[0],p2:f[h]}),p=x.dist(f[0],f[h]);this._linear=l.reduce((m,z)=>m+O(z.y),0)<p/50,this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(n,r,i,s){if(typeof s>"u"&&(s=.5),s===0)return new this(r,r,i);if(s===1)return new this(n,r,r);let o=this.getABC(2,n,r,i,s);return new this(n,o.A,i)}static cubicFromPoints(n,r,i,s,o){typeof s>"u"&&(s=.5);let c=this.getABC(3,n,r,i,s);typeof o>"u"&&(o=x.dist(r,c.C));let f=o*(1-s)/s,u=x.dist(n,i),h=(i.x-n.x)/u,a=(i.y-n.y)/u,l=o*h,p=o*a,m=f*h,z=f*a,M={x:r.x-l,y:r.y-p},q={x:r.x+m,y:r.y+z},k=c.A,A={x:k.x+(M.x-k.x)/(1-s),y:k.y+(M.y-k.y)/(1-s)},v={x:k.x+(q.x-k.x)/s,y:k.y+(q.y-k.y)/s},d={x:n.x+(A.x-n.x)/s,y:n.y+(A.y-n.y)/s},g={x:i.x+(v.x-i.x)/(1-s),y:i.y+(v.y-i.y)/(1-s)};return new this(n,d,g,i)}static getUtils(){return x}getUtils(){return x}static get PolyBezier(){return I}valueOf(){return this.toString()}toString(){return x.pointsToString(this.points)}toSVG(){if(this._3d)return!1;let n=this.points,r=n[0].x,i=n[0].y,s=["M",r,i,this.order===2?"Q":"C"];for(let o=1,c=n.length;o<c;o++)s.push(n[o].x),s.push(n[o].y);return s.join(" ")}setRatios(n){if(n.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=n,this._lut=[]}verify(){let n=this.coordDigest();n!==this._print&&(this._print=n,this.update())}coordDigest(){return this.points.map(function(n,r){return""+r+n.x+n.y+(n.z?n.z:0)}).join("")}update(){this._lut=[],this.dpoints=x.derive(this.points,this._3d),this.computedirection()}computedirection(){let n=this.points,r=x.angle(n[0],n[this.order],n[1]);this.clockwise=r>0}length(){return x.length(this.derivative.bind(this))}static getABC(n=2,r,i,s,o=.5){let c=x.projectionratio(o,n),f=1-c,u={x:c*r.x+f*s.x,y:c*r.y+f*s.y},h=x.abcratio(o,n);return{A:{x:i.x+(i.x-u.x)/h,y:i.y+(i.y-u.y)/h},B:i,C:u,S:r,E:s}}getABC(n,r){r=r||this.get(n);let i=this.points[0],s=this.points[this.order];return this.constructor.getABC(this.order,i,r,s,n)}get(n){return this.compute(n)}point(n){return this.points[n]}compute(n){return this.ratios?x.computeWithRatios(n,this.points,this.ratios,this._3d):x.compute(n,this.points,this._3d,this.ratios)}raise(){let n=this.points,r=[n[0]],i=n.length;for(let s=1,o,c;s<i;s++)o=n[s],c=n[s-1],r[s]={x:(i-s)/i*o.x+s/i*c.x,y:(i-s)/i*o.y+s/i*c.y};return r[i]=n[i-1],new this.constructor(r)}derivative(n){return x.compute(n,this.dpoints[0],this._3d)}dderivative(n){return x.compute(n,this.dpoints[1],this._3d)}curvature(n){return x.curvature(n,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return x.inflections(this.points)}};var Jt={getLUT(e){if(this.verify(),e=e||100,this._lut.length===e+1)return this._lut;this._lut=[],e++,this._lut=[];for(let n=0,r,i;n<e;n++)i=n/(e-1),r=this.compute(i),r.t=i,this._lut.push(r);return this._lut},on(e,n){n=n||5;let r=this.getLUT(),i=[];for(let s=0,o,c=0;s<r.length;s++)o=r[s],x.dist(o,e)<n&&(i.push(o),c+=s/r.length);return i.length?t/=i.length:!1},project(e){let n=this.getLUT(),r=n.length-1,i=x.closest(n,e),s=i.mpos,o=(s-1)/r,c=(s+1)/r,f=.1/r,u=i.mdist,h=o,a=h,l;u+=1;for(let p;h<c+f;h+=f)l=this.compute(h),p=x.dist(e,l),p<u&&(u=p,a=h);return a=a<0?0:a>1?1:a,l=this.compute(a),l.t=a,l.d=u,l},bbox(){let e=this.extrema(),n={};return this.dims.forEach(function(r){n[r]=x.getminmax(this,r,e[r])}.bind(this)),n},overlaps(e){let n=this.bbox(),r=e.bbox();return x.bboxoverlap(n,r)},extrema(){let e={},n=[];return this.dims.forEach(function(r){let i=function(o){return o[r]},s=this.dpoints[0].map(i);e[r]=x.droots(s),this.order===3&&(s=this.dpoints[1].map(i),e[r]=e[r].concat(x.droots(s))),e[r]=e[r].filter(function(o){return o>=0&&o<=1}),n=n.concat(e[r].sort(x.numberSort))}.bind(this)),e.values=n.sort(x.numberSort).filter(function(r,i){return n.indexOf(r)===i}),e}};var Lt={align(){let e=this.points;return new this.constructor(x.align(e,{p1:e[0],p2:e[e.length-1]}))},normal(e){return this._3d?this.__normal3(e):this.__normal2(e)},__normal2(e){let n=this.derivative(e),r=E(n.x*n.x+n.y*n.y);return{t:e,x:-n.y/r,y:n.x/r}},__normal3(e){let n=this.derivative(e),r=this.derivative(e+.01),i=E(n.x*n.x+n.y*n.y+n.z*n.z),s=E(r.x*r.x+r.y*r.y+r.z*r.z);n.x/=i,n.y/=i,n.z/=i,r.x/=s,r.y/=s,r.z/=s;let o={x:r.y*n.z-r.z*n.y,y:r.z*n.x-r.x*n.z,z:r.x*n.y-r.y*n.x},c=E(o.x*o.x+o.y*o.y+o.z*o.z);o.x/=c,o.y/=c,o.z/=c;let f=[o.x*o.x,o.x*o.y-o.z,o.x*o.z+o.y,o.x*o.y+o.z,o.y*o.y,o.y*o.z-o.x,o.x*o.z-o.y,o.y*o.z+o.x,o.z*o.z];return{t:e,x:f[0]*n.x+f[1]*n.y+f[2]*n.z,y:f[3]*n.x+f[4]*n.y+f[5]*n.z,z:f[6]*n.x+f[7]*n.y+f[8]*n.z}},hull(e){let n=this.points,r=[],i=[],s=0;for(i[s++]=n[0],i[s++]=n[1],i[s++]=n[2],this.order===3&&(i[s++]=n[3]);n.length>1;){r=[];for(let o=0,c,f=n.length-1;o<f;o++)c=x.lerp(e,n[o],n[o+1]),i[s++]=c,r.push(c);n=r}return i},split(e,n){if(e===0&&!!n)return this.split(n).left;if(n===1)return this.split(e).right;let r=this.hull(e),i={left:this.order===2?new this.constructor([r[0],r[3],r[5]]):new this.constructor([r[0],r[4],r[7],r[9]]),right:this.order===2?new this.constructor([r[5],r[4],r[2]]):new this.constructor([r[9],r[8],r[6],r[3]]),span:r};return i.left._t1=x.map(0,0,1,this._t1,this._t2),i.left._t2=x.map(e,0,1,this._t1,this._t2),i.right._t1=x.map(e,0,1,this._t1,this._t2),i.right._t2=x.map(1,0,1,this._t1,this._t2),n?(n=x.map(n,e,1,0,1),i.right.split(n).left):i},simple(){if(this.order===3){let i=x.angle(this.points[0],this.points[3],this.points[1]),s=x.angle(this.points[0],this.points[3],this.points[2]);if(i>0&&s<0||i<0&&s>0)return!1}let e=this.normal(0),n=this.normal(1),r=e.x*n.x+e.y*n.y;return this._3d&&(r+=e.z*n.z),O(V(r))<H/3},reduce(){let e,n=0,r=0,i=.01,s,o=[],c=[],f=this.extrema().values;for(f.indexOf(0)===-1&&(f=[0].concat(f)),f.indexOf(1)===-1&&f.push(1),n=f[0],e=1;e<f.length;e++)r=f[e],s=this.split(n,r),s._t1=n,s._t2=r,o.push(s),n=r;return o.forEach(function(u){for(n=0,r=0;r<=1;)for(r=n+i;r<=1+i;r+=i)if(s=u.split(n,r),!s.simple()){if(r-=i,O(n-r)<i)return[];s=u.split(n,r),s._t1=x.map(n,0,1,u._t1,u._t2),s._t2=x.map(r,0,1,u._t1,u._t2),c.push(s),n=r;break}n<1&&(s=u.split(n,1),s._t1=x.map(n,0,1,u._t1,u._t2),s._t2=u._t2,c.push(s))}),c}};var Pt={offset(e,n){if(typeof n<"u"){let r=this.get(e),i=this.normal(e),s={c:r,n:i,x:r.x+i.x*n,y:r.y+i.y*n};return this._3d&&(s.z=r.z+i.z*n),s}if(this._linear){let r=this.normal(0),i=this.points.map(function(s){let o={x:s.x+e*r.x,y:s.y+e*r.y};return s.z&&r.z&&(o.z=s.z+e*r.z),o});return[new this.constructor(i)]}return this.reduce().map(function(r){return r._linear?r.offset(e)[0]:r.scale(e)})},translate(e,n,r){r=typeof r=="number"?r:n;let i=this.order,s=this.points.map((o,c)=>(1-c/i)*n+c/i*r);return new this.constructor(this.points.map((o,c)=>({x:o.x+e.x*s[c],y:o.y+e.y*s[c]})))},scale(e){let n=this.order,r=!1;if(typeof e=="function"&&(r=e),r&&n===2)return this.raise().scale(r);let i=this.clockwise,s=this.points;if(this._linear)return this.translate(this.normal(0),r?r(0):e,r?r(1):e);let o=r?r(0):e,c=r?r(1):e,f=[this.offset(0,10),this.offset(1,10)],u=[],h=x.lli4(f[0],f[0].c,f[1],f[1].c);if(!h)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach(function(a){let l=u[a*n]=x.copy(s[a*n]);l.x+=(a?c:o)*f[a].n.x,l.y+=(a?c:o)*f[a].n.y}),r?([0,1].forEach(function(a){if(!(n===2&&!!a)){var l=s[a+1],p={x:l.x-h.x,y:l.y-h.y},m=r?r((a+1)/n):e;r&&!i&&(m=-m);var z=E(p.x*p.x+p.y*p.y);p.x/=z,p.y/=z,u[a+1]={x:l.x+m*p.x,y:l.y+m*p.y}}}),new this.constructor(u)):([0,1].forEach(a=>{if(n===2&&!!a)return;let l=u[a*n],p=this.derivative(a),m={x:l.x+p.x,y:l.y+p.y};u[a+1]=x.lli4(l,m,h,s[a+1])}),new this.constructor(u))},outline(e,n,r,i){if(n=n===void 0?e:n,this._linear){let d=this.normal(0),g=this.points[0],b=this.points[this.points.length-1],y,_,w;r===void 0&&(r=e,i=n),y={x:g.x+d.x*e,y:g.y+d.y*e},w={x:b.x+d.x*r,y:b.y+d.y*r},_={x:(y.x+w.x)/2,y:(y.y+w.y)/2};let C=[y,_,w];y={x:g.x-d.x*n,y:g.y-d.y*n},w={x:b.x-d.x*i,y:b.y-d.y*i},_={x:(y.x+w.x)/2,y:(y.y+w.y)/2};let S=[w,_,y],R=x.makeline(S[2],C[0]),W=x.makeline(C[2],S[0]),L=[R,new this.constructor(C),W,new this.constructor(S)];return new I(L)}let s=this.reduce(),o=s.length,c=[],f=[],u,h=0,a=this.length(),l=typeof r<"u"&&typeof i<"u";function p(d,g,b,y,_){return function(w){let C=y/b,S=(y+_)/b,R=g-d;return x.map(w,0,1,d+C*R,d+S*R)}}s.forEach(function(d){let g=d.length();l?(c.push(d.scale(p(e,r,a,h,g))),f.push(d.scale(p(-n,-i,a,h,g)))):(c.push(d.scale(e)),f.push(d.scale(-n))),h+=g}),f=f.map(function(d){return u=d.points,u[3]?d.points=[u[3],u[2],u[1],u[0]]:d.points=[u[2],u[1],u[0]],d}).reverse();let m=c[0].points[0],z=c[o-1].points[c[o-1].points.length-1],M=f[o-1].points[f[o-1].points.length-1],q=f[0].points[0],k=x.makeline(M,m),A=x.makeline(z,q),v=[k].concat(c).concat([A]).concat(f);return new I(v)},outlineshapes(e,n,r){n=n||e;let i=this.outline(e,n).curves,s=[];for(let o=1,c=i.length;o<c/2;o++){let f=x.makeshape(i[o],i[c-o],r);f.startcap.virtual=o>1,f.endcap.virtual=o<c/2-1,s.push(f)}return s}};var Dt={intersects(e,n){return e?e.p1&&e.p2?this.lineIntersects(e):((e.constructor.name==="Bezier"||e instanceof this.constructor)&&(e=e.reduce()),this.curveintersects(this.reduce(),e,n)):this.selfintersects(n)},lineIntersects(e){let n=ct(e.p1.x,e.p2.x),r=ct(e.p1.y,e.p2.y),i=ft(e.p1.x,e.p2.x),s=ft(e.p1.y,e.p2.y);return x.roots(this.points,e).filter(o=>{var c=this.get(o);return x.between(c.x,n,i)&&x.between(c.y,r,s)})},selfintersects(e){let n=this.reduce(),r=n.length-2,i=[];for(let s=0,o,c,f;s<r;s++)c=n.slice(s,s+1),f=n.slice(s+2),o=this.curveintersects(c,f,e),i.push(...o);return i},curveintersects(e,n,r){let i=[];e.forEach(function(o){n.forEach(function(c){o.overlaps(c)&&i.push({left:o,right:c})})});let s=[];return i.forEach(function(o){let c=x.pairiteration(o.left,o.right,r);c.length>0&&(s=s.concat(c))}),s}};var Gt={arcs(e){return e=e||.5,this._iterate(e,[])},_error(e,n,r,i){let s=(i-r)/4,o=this.get(r+s),c=this.get(i-s),f=x.dist(e,n),u=x.dist(e,o),h=x.dist(e,c);return O(u-f)+O(h-f)},_iterate(e,n){let r=0,i=1,s;do{s=0,i=1;let o=this.get(r),c,f,u,h,a=!1,l=!1,p,m=i,z=1,M=0;do if(l=a,h=u,m=(r+i)/2,M++,c=this.get(m),f=this.get(i),u=x.getccenter(o,c,f),u.interval={start:r,end:i},a=this._error(u,o,r,i)<=e,p=l&&!a,p||(z=i),a){if(i>=1){if(u.interval.end=z=1,h=u,i>1){let k={x:u.x+u.r*N(u.e),y:u.y+u.r*F(u.e)};u.e+=x.angle({x:u.x,y:u.y},k,this.get(1))}break}i=i+(i-r)/2}else i=m;while(!p&&s++<100);if(s>=100)break;h=h||u,n.push(h),r=z}while(i<1);return n}};var J=class extends ot{constructor(...n){super(...n)}};Object.assign(J.prototype,Jt);Object.assign(J.prototype,Lt);Object.assign(J.prototype,Pt);Object.assign(J.prototype,Dt);Object.assign(J.prototype,Gt);Ut(J);})();
